dist: trusty
sudo: required

language: python
python:
  - "2.7"
  - "3.5"
  - "3.6"

notifications:
  email: false

install:
  - pip install -U tox-travis pip setuptools wheel
  - pip install -r requirements_dev.txt

script:
  # Build and test extension module
  - python setup.py build_ext --inplace
  - LD_LIBRARY_PATH="$TRAVIS_BUILD_DIR/tiledb:$LD_LIBRARY_PATH" python -m unittest tiledb.tests.all.suite_test
  - # LD_LIBRARY_PATH="$TRAVIS_BUILD_DIR/tiledb:$LD_LIBRARY_PATH" python -m doctest tiledb/libtiledb.pyx
  # Check wheel build
  - python setup.py bdist_wheel
  - whl_file=`pwd`/dist/`ls dist`
  - pushd /tmp
  - echo "Installing wheel file from $whl_file..."
  - pip install $whl_file
  - python -c "import tiledb ; tiledb.libtiledb.version()"
  - python $TRAVIS_BUILD_DIR/examples/quickstart_dense.py
  - python $TRAVIS_BUILD_DIR/examples/quickstart_sparse.py
  - python $TRAVIS_BUILD_DIR/examples/quickstart_kv.py